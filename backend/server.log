/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
âœ… Audio processing available
âœ… PDF processing available
 * Serving Flask app 'app'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.250.112:5001
[33mPress CTRL+C to quit[0m
 * Restarting with stat
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
 * Debugger is active!
 * Debugger PIN: 130-091-692
127.0.0.1 - - [12/Aug/2025 21:01:28] "[33mHEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/1?type=thumbnail HTTP/1.1[0m" 404 -
 * Detected change in '/Users/parthshah/Desktop/projects/ai-math-tutor/backend/pdf_image_service.py', reloading
âœ… Audio processing available
âœ… PDF processing available
 * Restarting with stat
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
 * Debugger is active!
 * Debugger PIN: 130-091-692
127.0.0.1 - - [12/Aug/2025 21:02:05] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/1?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:11] "HEAD /api/audio-segment/23eb1cb1-6d5f-49a8-aa49-4721f04e8374/1 HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/1?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/1?type=full HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/2?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/2?type=full HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/3?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/3?type=full HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/4?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/slide-image/d5821c5f-1029-4730-a0cd-6c0154bd9db8/4?type=full HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:02:47] "HEAD /api/audio-segment/23eb1cb1-6d5f-49a8-aa49-4721f04e8374/1 HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:49:35] "POST /api/process-upload HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:49:48] "OPTIONS /api/assignments/uploaded_1ecc3120-61aa-400f-9c06-ed369512d1bc_airbnb-shortened.pdf/slides HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:49:48] "POST /api/assignments/uploaded_1ecc3120-61aa-400f-9c06-ed369512d1bc_airbnb-shortened.pdf/slides HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:49:58] "POST /api/chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:50:01] "OPTIONS /api/chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:50:04] "POST /api/chat HTTP/1.1" 200 -
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:198: RuntimeWarning: Couldn't find ffprobe or avprobe - defaulting to ffprobe, but may not work
  warn("Couldn't find ffprobe or avprobe - defaulting to ffprobe, but may not work", RuntimeWarning)
127.0.0.1 - - [12/Aug/2025 21:51:01] "POST /api/feedback HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:51:50] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/1?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:51:50] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/3?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:51:50] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/2?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:51:50] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/4?type=thumbnail HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:52:19] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/1?type=full HTTP/1.1" 200 -
127.0.0.1 - - [12/Aug/2025 21:52:23] "GET /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/2?type=full HTTP/1.1" 200 -
 * Detected change in '/Users/parthshah/Desktop/projects/ai-math-tutor/backend/feedback_service.py', reloading
âœ… Audio processing available
âœ… PDF processing available
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_1_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_1_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_1_full.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_2_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_2_full.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_3_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_3_full.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_4_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/d5821c5f-1029-4730-a0cd-6c0154bd9db8/slide_4_full.png
ğŸ” File exists: True
ğŸ“ Saved uploaded PDF to: /Users/parthshah/Desktop/projects/ai-math-tutor/backend/assignments/uploaded_1ecc3120-61aa-400f-9c06-ed369512d1bc_airbnb-shortened.pdf
ğŸ“„ Starting PDF processing: /Users/parthshah/Desktop/projects/ai-math-tutor/backend/assignments/uploaded_1ecc3120-61aa-400f-9c06-ed369512d1bc_airbnb-shortened.pdf
ğŸ“ PDF file exists: True
ğŸ“ PDF file size: 214843 bytes
ğŸ“ Session directory created: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc
ğŸ“„ Converting PDF to images: /Users/parthshah/Desktop/projects/ai-math-tutor/backend/assignments/uploaded_1ecc3120-61aa-400f-9c06-ed369512d1bc_airbnb-shortened.pdf
âœ… PDF conversion successful: 4 pages
ğŸ“· Processing slide 1...
âœ… Saved slide 1
ğŸ“· Processing slide 2...
âœ… Saved slide 2
ğŸ“· Processing slide 3...
âœ… Saved slide 3
ğŸ“· Processing slide 4...
âœ… Saved slide 4
âœ… Successfully converted 4 slides
ğŸ“„ Detected 4 pages in PDF
ğŸŒ API /chat endpoint called
ğŸ“‹ Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryKucJiMsBBgrk1jLm
ğŸµ Multipart request detected - checking for audio...
ğŸ™ï¸ Audio file received: recording.wav
ğŸ“ Audio file size: 0 bytes
ğŸ’¾ Audio saved to temporary file: /var/folders/t9/90kgxqcx6wd2x1bhj5m1d0wm0000gn/T/tmp_uty3ihj.wav
ğŸ”Š Starting audio transcription with Whisper...
âœ… Audio transcription successful!
ğŸ“ Transcription: Test 1, test 2, test 3, test 4.

ğŸ—‘ï¸ Temporary audio file cleaned up
ğŸ¤– AI service called
ğŸ“„ PDF context provided: True
ğŸ™ï¸ Audio transcription provided: True
ğŸ“ Transcription length: 32 characters
ğŸ“ Transcription preview: Test 1, test 2, test 3, test 4.
...
ğŸ¯ Adding audio transcription to AI context!
ğŸŒ API /chat endpoint called
ğŸ“‹ Content-Type: application/json
ğŸ¤– AI service called
ğŸ“„ PDF context provided: True
ğŸ™ï¸ Audio transcription provided: False
ğŸ“ API /feedback endpoint called
ğŸ“‹ Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryTeBlQAJSAM6cYIQn
ğŸµ Multipart request with recording detected...
ğŸ“Š Slide timestamps received: [{'slideNumber': 1, 'timestamp': 0}, {'slideNumber': 2, 'timestamp': 1.851}, {'slideNumber': 3, 'timestamp': 3.402}, {'slideNumber': 4, 'timestamp': 3.519}]
ğŸ“„ PDF slide count received: 4
ğŸ“„ PDF session ID received: 1ecc3120-61aa-400f-9c06-ed369512d1bc
ğŸ™ï¸ Recording file received: presentation.wav
ğŸ“ Generating slide-specific feedback...
ğŸ’¬ Conversation messages: 5
ğŸ“„ Slide content provided: True
ğŸ™ï¸ Presentation recording provided: True
ğŸ“Š Slide timestamps provided: 4
ğŸ“Š Detailed timestamps: [{'slideNumber': 1, 'timestamp': 0}, {'slideNumber': 2, 'timestamp': 1.851}, {'slideNumber': 3, 'timestamp': 3.402}, {'slideNumber': 4, 'timestamp': 3.519}]
  - Timestamp 0: Slide 1, Time: 0s
  - Timestamp 1: Slide 2, Time: 1.851s
  - Timestamp 2: Slide 3, Time: 3.402s
  - Timestamp 3: Slide 4, Time: 3.519s
ğŸ“„ PDF session ID: 1ecc3120-61aa-400f-9c06-ed369512d1bc
ğŸ“„ PDF slide count: 4
ğŸ”Š Processing slide-specific audio segments...
âŒ Audio splitting failed: [Errno 2] No such file or directory: 'ffprobe'
âš ï¸ Audio splitting returned only one segment, treating as full audio
ğŸ“ Created fake segment for slide 1: 7 chars
ğŸ“ Created fake segment for slide 2: 7 chars
ğŸ“ Created fake segment for slide 3: 7 chars
ğŸ“ Created fake segment for slide 4: 7 chars
ğŸ“Š Final actual slide count: 4
ğŸ“Š Generating per-slide feedback for 4 slides based on timestamps
ğŸ“Š Slide timestamps (filtered): [{'slideNumber': 1, 'timestamp': 0}, {'slideNumber': 2, 'timestamp': 1.851}, {'slideNumber': 3, 'timestamp': 3.402}, {'slideNumber': 4, 'timestamp': 3.519}]
ğŸ“Š Audio transcripts available for slides: [1, 2, 3, 4]
ğŸ“Š Processing slide 1 (index 0)
ğŸ“Š Using audio transcript for slide 1
âœ… Successfully generated feedback for slide 1
ğŸ“Š Processing slide 2 (index 1)
ğŸ“Š Using audio transcript for slide 2
âœ… Successfully generated feedback for slide 2
ğŸ“Š Processing slide 3 (index 2)
ğŸ“Š Using audio transcript for slide 3
âœ… Successfully generated feedback for slide 3
ğŸ“Š Processing slide 4 (index 3)
ğŸ“Š Using audio transcript for slide 4
âœ… Successfully generated feedback for slide 4
ğŸ“Š Session IDs:
  - Feedback session (audio): a5f388cd-6b7c-4b86-8b51-29a88c7534ce
  - Image session (PDF): 1ecc3120-61aa-400f-9c06-ed369512d1bc
âš ï¸ Audio transcripts available but no segments to save
ğŸ“Š Building slide 1 data:
  - Has audio: False
  - Audio saved at: Not saved
  - Audio URL: None
  - Image URL: /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/1?type=thumbnail
  - Image session: 1ecc3120-61aa-400f-9c06-ed369512d1bc
  - Audio session: a5f388cd-6b7c-4b86-8b51-29a88c7534ce
ğŸ“Š Building slide 2 data:
  - Has audio: False
  - Audio saved at: Not saved
  - Audio URL: None
  - Image URL: /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/2?type=thumbnail
  - Image session: 1ecc3120-61aa-400f-9c06-ed369512d1bc
  - Audio session: a5f388cd-6b7c-4b86-8b51-29a88c7534ce
ğŸ“Š Building slide 3 data:
  - Has audio: False
  - Audio saved at: Not saved
  - Audio URL: None
  - Image URL: /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/3?type=thumbnail
  - Image session: 1ecc3120-61aa-400f-9c06-ed369512d1bc
  - Audio session: a5f388cd-6b7c-4b86-8b51-29a88c7534ce
ğŸ“Š Building slide 4 data:
  - Has audio: False
  - Audio saved at: Not saved
  - Audio URL: None
  - Image URL: /api/slide-image/1ecc3120-61aa-400f-9c06-ed369512d1bc/4?type=thumbnail
  - Image session: 1ecc3120-61aa-400f-9c06-ed369512d1bc
  - Audio session: a5f388cd-6b7c-4b86-8b51-29a88c7534ce
âœ… Structured feedback generated for 4 slides
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_1_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_2_thumb.png
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_3_thumb.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_4_thumb.png
ğŸ” File exists: True
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_1_full.png
ğŸ” File exists: True
ğŸ” Looking for image at: slide_images/1ecc3120-61aa-400f-9c06-ed369512d1bc/slide_2_full.png
ğŸ” File exists: True
 * Restarting with stat
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
 * Debugger is active!
 * Debugger PIN: 130-091-692
 * Detected change in '/Users/parthshah/Desktop/projects/ai-math-tutor/backend/feedback_service.py', reloading
âœ… Audio processing available
âœ… PDF processing available
 * Restarting with stat
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
 * Debugger is active!
 * Debugger PIN: 130-091-692
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:301: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-y5akt3c3'}
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:301: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-x9w5htcr'}
  warnings.warn(
